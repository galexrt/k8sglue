{{ pillar['headers']['salt']['file'] }}

reactor:
  - 'salt/auth':
    # Do minion key check if needed
    - /srv/reactor/minion/auth.sls
  # Minion has started (this is after the key has been accepted)
  - 'salt/minion/*/start':
    - /srv/reactor/minion/sync_all.sls
    # Trigger salt key check if the minion isn't already in the list of accepted minions
#    - /srv/reactor/minion/highstate.sls
  # A node that wants to join the Kubernetes node sends this signal
  - 'custom/kubernetes/want-to-join':
    # Generate a kubeadm token for a node that wants to join the cluster
    - /srv/reactor/kubernetes/token-generate.sls
  # A token has been generated
  - 'custom/kubernetes/token-generated':
    # Join the node using the generated token
    - /srv/reactor/kubernetes/join-node.sls
# If you want to trigger a reactor when a Kubernetes node joins through the salt code
#  - 'custom/kubernetes/joined':
#    - /srv/reactor/yourownreactor/node-joined.sls

log_level: debug
