{{ pillar['headers']['salt']['file'] }}

reactor:
  - 'salt/auth':
    # Do minion key check if needed
    - /srv/reactor/salt/auth/minion_key_verify.sls
  # Minion has started (this is after the key has been accepted)
  - 'salt/minion/*/start':
    - /srv/reactor/salt/minion/start/sync_all.sls
    # Trigger salt key check if the minion isn't already in the list of accepted minions
    - /srv/reactor/salt/minion/start/highstate.sls
#    # Trigger custom/kubernetes/want-to-join event for the node
#    - /srv/reactor/salt/minion/start/kubernetes_new_node.sls
#  # A node that wants to join the Kubernetes node sends this signal
#  - 'custom/kubernetes/want-to-join':
#    # Generate a kubeadm token for a node that wants to join the cluster
#    - /srv/reactor/custom/kubernetes/token-generate.sls
#  # A token has been generated
#  - 'custom/kubernetes/token-generated':
#    # Join the node using the generated token
#    - /srv/reactor/custom/kubernetes/join-node.sls
#  # If you want to trigger a reaction when a node has joined the Kubernetes cluster through the salt code add it here
#  - 'custom/kubernetes/joined':
#    - /srv/reactor/custom/kubernetes/node_joined.sls

log_level: debug
